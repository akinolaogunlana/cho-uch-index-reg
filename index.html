<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="style.css">
  <title>CHO INDEXING FORM</title>
</head>
<body>

<h2>CHO INDEXING DATA COLLECTION</h2>

<form id="indexForm" enctype="multipart/form-data">

  <h3>PERSONAL INFORMATION</h3>
  <input name="surname" placeholder="SURNAME" required>
  <input name="firstname" placeholder="FIRSTNAME" required>
  <input name="othernames" placeholder="OTHERNAMES">

  <label for="passport">PASSPORT</label>
  <input type="file" name="passport" id="passport" accept="image/*" required>

  <input name="cadre" value="CHO" readonly>

  <select name="gender" required>
    <option value="">SELECT GENDER</option>
    <option value="MALE">MALE</option>
    <option value="FEMALE">FEMALE</option>
  </select>

  <input name="bloodgroup" placeholder="BLOOD GROUP">
  <input name="state" placeholder="STATE">
  <input name="lga" placeholder="LGA / CITY / TOWN">

  <label for="dob">DATE OF BIRTH</label>
  <input type="date" name="dob" id="dob" required>

  <h3>O'LEVEL</h3>
  <select name="olevel_type" required>
    <option value="">SELECT O-LEVEL TYPE</option>
    <option value="WAEC">WAEC (Single Sitting)</option>
    <option value="NECO">NECO (Single Sitting)</option>
    <option value="WAEC / WAEC">WAEC / WAEC (Two Sittings)</option>
    <option value="NECO / NECO">NECO / NECO (Two Sittings)</option>
    <option value="NECO / WAEC">NECO / WAEC (Combined)</option>
  </select>
  <input name="olevel_year" placeholder="O-LEVEL YEAR(S)">
  <input name="olevel_exam" placeholder="O-LEVEL EXAM NUMBER">

  <h3>A'LEVEL / PROFESSIONAL</h3>
  <input name="alevel_type" placeholder="A-LEVEL TYPE">
  <input name="alevel_year" placeholder="A-LEVEL YEAR">
  <input name="pro_cert" placeholder="PROFESSIONAL CERTIFICATE NUMBER">

  <h3>SUBJECTS & GRADES</h3>

  <label>ENGLISH</label>
  <input id="engGrade" placeholder="GRADE" required>
  <select id="engBody">
    <option value="WAEC">WAEC</option>
    <option value="NECO">NECO</option>
  </select>

  <label>MATHEMATICS</label>
  <input id="mathGrade" placeholder="GRADE" required>
  <select id="mathBody">
    <option value="WAEC">WAEC</option>
    <option value="NECO">NECO</option>
  </select>

  <label>BIOLOGY / HEALTH SCIENCE</label>
  <input id="bioGrade" placeholder="GRADE">
  <select id="bioBody">
    <option value="WAEC">WAEC</option>
    <option value="NECO">NECO</option>
  </select>

  <label>CHEMISTRY</label>
  <input id="chemGrade" placeholder="GRADE">
  <select id="chemBody">
    <option value="WAEC">WAEC</option>
    <option value="NECO">NECO</option>
  </select>

  <label>PHYSICS</label>
  <input id="phyGrade" placeholder="GRADE">
  <select id="phyBody">
    <option value="WAEC">WAEC</option>
    <option value="NECO">NECO</option>
  </select>

  <!-- Hidden fields to match Sheet column names -->
  <input type="hidden" name="english">
  <input type="hidden" name="maths">
  <input type="hidden" name="biology">
  <input type="hidden" name="chemistry">
  <input type="hidden" name="physics">

  <input name="remarks" placeholder="REMARKS">

  <br><br>
  <button type="submit">SUBMIT</button>

</form>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzieIuL9kZqDLTmrQlW_FoRNEgJmeGjK2HMac_PIHhtUeogci_TwQgtTyZ3YoUUHg/exec";

const form = document.getElementById("indexForm");

form.addEventListener("submit", async function(e) {
  e.preventDefault();

  const formData = new FormData(form);

  // Combine grades + exam board
  formData.set("english", document.getElementById("engGrade").value + " (" + document.getElementById("engBody").value + ")");
  formData.set("maths", document.getElementById("mathGrade").value + " (" + document.getElementById("mathBody").value + ")");
  formData.set("biology", document.getElementById("bioGrade").value + " (" + document.getElementById("bioBody").value + ")");
  formData.set("chemistry", document.getElementById("chemGrade").value + " (" + document.getElementById("chemBody").value + ")");
  formData.set("physics", document.getElementById("phyGrade").value + " (" + document.getElementById("phyBody").value + ")");

  try {
    const res = await fetch(SCRIPT_URL, { method: "POST", body: formData });
    const text = await res.text();
    alert(text);
    if (text === "SUCCESS") form.reset();
  } catch (err) {
    alert("Submission failed. Please try again.");
    console.error(err);
  }
});
</script>

</body>
</html>